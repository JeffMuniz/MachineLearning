{
    "name": "conn-in-rebate-efetivado",
    "config": {
      "version": 1,
      "description": "Conector de entrada de dados referente ao rebate efetivado",
      "connector.class": "io.confluent.connect.jdbc.JdbcSourceConnector",
      "connection.url": "jdbc:sqlserver://{{ENV_DB_HOST}}:{{ENV_DB_PORT}};databaseName={{ENV_DB_BLUE_NAME}}",
      "connection.user": "{{ENV_DB_USER}}",
      "connection.passingthroughportalword": "{{ENV_DB_passingthroughportalword}}",
      "topic.prefix": "topic-conn-conf-rebate-efetivado",
      "poll.interval.ms": "60000",
      "mode": "timestamp",
      "timestamp.column.name": "dt_movimento",
      "timestamp.initial": -1,
      "validate.non.null": true,
      "query": "SELECT  *\nFROM\n(\n\tSELECT  DISTINCT BE.Id_Boleto                 AS id_boleto\n\t       ,CAST(be.ValorRebate AS NUMERIC(15,2)) AS valor\n\t       ,EP.DataEntradaPagamento               AS dt_movimento\n\tFROM arquivocargastd arq\n\tINNER JOIN CargasCredito cb\n\tON cb.ID_ARQUIVOCARGASTD = arq.ID_ARQUIVOCARGASTD\n\tINNER JOIN CargaControleFinanceiro cf\n\tON cf.Id_CargaControleFinanceiro = cb.Id_CargaControleFinanceiro\n\tINNER JOIN BoletosEmitidos be\n\tON be.Id_Boleto = cf.Id_Boleto\n\tINNER JOIN EventosExternosPagamentos EP (nolock)\n\tON BE.Id_EventoPagamento = EP.Id_EventoPagamento\n\tWHERE cb.status <> 6\n\tAND ARQ.STATUS IN (3, 4, 5, 6)\n\tAND BE.ValorRebate > 0\n\tAND EP.DataEntradaPagamento IS NOT NULL \n) AS RebateEfetivado",
      "key.converter.schema.registry.url": "https://{{ENV_API_SCHEMA_REGISTRY_URL}}",
      "value.converter.schema.registry.url": "https://{{ENV_API_SCHEMA_REGISTRY_URL}}",
      "value.converter.schema.registry.basic.auth.user.info": "{{ENV_API_SCHEMA_REGISTRY_KEY}}:{{ENV_API_SCHEMA_REGISTRY_SECRET}}",
      "key.converter.schema.registry.basic.auth.user.info": "{{ENV_API_SCHEMA_REGISTRY_KEY}}:{{ENV_API_SCHEMA_REGISTRY_SECRET}}",
      "auto.register.schemas": "true",
      "transforms": "createKey,extractInt,setSchemaName",
      "transforms.createKey.type": "org.apache.kafka.connect.transforms.ValueToKey",
      "transforms.createKey.fields": "id_boleto",
      "transforms.extractInt.type": "org.apache.kafka.connect.transforms.ExtractField$Key",
      "transforms.extractInt.field": "id_boleto",
      "transforms.setSchemaName.type": "org.apache.kafka.connect.transforms.SetSchemaMetadata$Value",
      "transforms.setSchemaName.schema.name": "br.com.mac-edu.schema.ConnConfirmacaoRebateEfetivadoValue",
      "key.converter": "io.confluent.connect.avro.AvroConverter",
      "value.converter": "io.confluent.connect.avro.AvroConverter",
      "value.converter.basic.auth.credentials.source": "USER_INFO",
      "key.converter.basic.auth.credentials.source": "USER_INFO"
    }
  }