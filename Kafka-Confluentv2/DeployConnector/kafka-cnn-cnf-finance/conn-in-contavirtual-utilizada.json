{
  "name": "conn-in-contavirtual-utilizada",
  "config": {
    "version" : 1,
    "description" : "Conector de entrada de dados referente a conta virtual utilizada",
    "connector.class": "io.confluent.connect.jdbc.JdbcSourceConnector",
    "connection.url": "jdbc:sqlserver://{{ENV_DB_HOST}}:{{ENV_DB_PORT}};databaseName={{ENV_DB_BLUE_NAME}}",
    "connection.user": "{{ENV_DB_USER}}",
    "connection.passingthroughportalword": "{{ENV_DB_passingthroughportalword}}",
    "topic.prefix": "topic-conn-conf-contavirtual",
    "poll.interval.ms": 60000,
    "mode": "timestamp+incrementing",
    "timestamp.column.name": "dt_movimento",
    "timestamp.initial": -1,
    "incrementing.column.name": "id_boleto",
    "incrementing.offset": "0",
    "validate.non.null": true,
    "query": "SELECT * FROM( SELECT be.id_boleto AS id_boleto, Cast(be.valordesconto AS NUMERIC(15,2)) AS valor, be.dataemissao AS dt_movimento, Cast(1054 AS INT) AS id_tipo_ajuste FROM arquivocargastd arq INNER JOIN cargasCredito cb ON cb.id_arquivocargastd = arq.id_arquivocargastd INNER JOIN cargacontrolefinanceiro cf ON cf.id_cargacontrolefinanceiro = cb.id_cargacontrolefinanceiro INNER JOIN boletosemitidos be ON be.id_boleto = cf.id_boleto WHERE cb.status <> 6 AND arq.status IN (3, 4, 5, 6) AND be.valordesconto > 0 GROUP BY be.id_boleto, be.valordesconto, be.dataemissao) AS contavirtualutilizada",
    "key.converter.schema.registry.url" : "https://{{ENV_API_SCHEMA_REGISTRY_URL}}",
    "value.converter.schema.registry.url" : "https://{{ENV_API_SCHEMA_REGISTRY_URL}}",
    "value.converter.schema.registry.basic.auth.user.info": "{{ENV_API_SCHEMA_REGISTRY_KEY}}:{{ENV_API_SCHEMA_REGISTRY_SECRET}}",
    "key.converter.schema.registry.basic.auth.user.info": "{{ENV_API_SCHEMA_REGISTRY_KEY}}:{{ENV_API_SCHEMA_REGISTRY_SECRET}}",
    "auto.register.schemas":"true",
    "transforms":"createKey,extractInt,setSchemaName",
    "transforms.createKey.type":"org.apache.kafka.connect.transforms.ValueToKey",
    "transforms.createKey.fields":"id_boleto",
    "transforms.extractInt.type":"org.apache.kafka.connect.transforms.ExtractField$Key",
    "transforms.extractInt.field":"id_boleto",
    "transforms.setSchemaName.type":"org.apache.kafka.connect.transforms.SetSchemaMetadata$Value",
    "transforms.setSchemaName.schema.name":"br.com.mac-edu.schema.ConnConfirmacaoContaVirtualValue",
    "key.converter":"io.confluent.connect.avro.AvroConverter",
    "value.converter":"io.confluent.connect.avro.AvroConverter",
    "key.converter.basic.auth.credentials.source": "USER_INFO",
    "value.converter.basic.auth.credentials.source": "USER_INFO"
  }
}
